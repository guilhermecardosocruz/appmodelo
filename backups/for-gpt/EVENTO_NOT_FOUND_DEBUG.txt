
===== app/api/eventos/route.ts =====
1 import { NextResponse } from "next/server";
2 import { prisma } from "@/lib/prisma";
3 
4 const VALID_TYPES = ["PRE_PAGO", "POS_PAGO", "FREE"] as const;
5 type EventType = (typeof VALID_TYPES)[number];
6 
7 // GET /api/eventos - lista todos os eventos
8 export async function GET() {
9   const events = await prisma.event.findMany({
10     orderBy: { createdAt: "desc" },
11   });
12 
13   return NextResponse.json(events);
14 }
15 
16 // POST /api/eventos - cria um novo evento
17 export async function POST(request: Request) {
18   try {
19     const body = await request.json();
20     const name = String(body.name ?? "").trim();
21     const type = String(body.type ?? "").toUpperCase() as EventType;
22 
23     if (!name) {
24       return NextResponse.json(
25         { error: "Nome do evento é obrigatório." },
26         { status: 400 }
27       );
28     }
29 
30     if (!VALID_TYPES.includes(type)) {
31       return NextResponse.json(
32         { error: "Tipo de evento inválido." },
33         { status: 400 }
34       );
35     }
36 
37     const event = await prisma.event.create({
38       data: {
39         name,
40         type,
41       },
42     });
43 
44     return NextResponse.json(event, { status: 201 });
45   } catch (err) {
46     console.error("Erro ao criar evento:", err);
47     return NextResponse.json(
48       { error: "Erro ao criar evento." },
49       { status: 500 }
50     );
51   }
52 }
53 
54 // PATCH /api/eventos - atualiza um evento existente (id no corpo)
55 export async function PATCH(request: Request) {
56   try {
57     const body = await request.json();
58     const id = String(body.id ?? "").trim();
59 
60     if (!id) {
61       return NextResponse.json(
62         { error: "ID do evento é obrigatório para atualizar." },
63         { status: 400 }
64       );
65     }
66 
67     const data: {
68       name?: string;
69       description?: string | null;
70       location?: string | null;
71       inviteSlug?: string | null;
72     } = {};
73 
74     if (typeof body.name === "string") {
75       const name = body.name.trim();
76       if (!name) {
77         return NextResponse.json(
78           { error: "Nome do evento não pode ser vazio." },
79           { status: 400 }
80         );
81       }
82       data.name = name;
83     }
84 
85     if (typeof body.description === "string" || body.description === null) {
86       data.description = body.description;
87     }
88 
89     if (typeof body.location === "string" || body.location === null) {
90       data.location = body.location;
91     }
92 
93     if (typeof body.inviteSlug === "string" || body.inviteSlug === null) {
94       data.inviteSlug = body.inviteSlug;
95     }
96 
97     if (Object.keys(data).length === 0) {
98       return NextResponse.json(
99         { error: "Nenhum campo para atualizar." },
100         { status: 400 }
101       );
102     }
103 
104     const updated = await prisma.event.update({
105       where: { id },
106       data,
107     });
108 
109     return NextResponse.json(updated);
110   } catch (err) {
111     console.error("Erro ao atualizar evento:", err);
112     return NextResponse.json(
113       { error: "Erro ao atualizar evento." },
114       { status: 500 }
115     );
116   }
117 }
118 
119 // DELETE /api/eventos - exclui um evento (id no corpo)
120 export async function DELETE(request: Request) {
121   try {
122     const body = await request.json();
123     const id = String(body.id ?? "").trim();
124 
125     if (!id) {
126       return NextResponse.json(
127         { error: "ID do evento é obrigatório para excluir." },
128         { status: 400 }
129       );
130     }
131 
132     await prisma.event.delete({
133       where: { id },
134     });
135 
136     return NextResponse.json({ ok: true }, { status: 200 });
137   } catch (err) {
138     console.error("Erro ao excluir evento:", err);
139     return NextResponse.json(
140       { error: "Erro ao excluir evento." },
141       { status: 500 }
142     );
143   }
144 }

===== app/api/events/[id]/route.ts =====
[MISSING] app/api/events/[id]/route.ts

===== prisma/schema.prisma =====
1 generator client {
2   provider = "prisma-client-js"
3 }
4 
5 datasource db {
6   provider = "postgresql"
7   url      = env("DATABASE_URL")
8 }
9 
10 enum EventType {
11   PRE_PAGO
12   POS_PAGO
13   FREE
14 }
15 
16 model User {
17   id           String                @id @default(cuid())
18   name         String
19   email        String                @unique
20   passwordHash String
21   createdAt    DateTime              @default(now())
22   updatedAt    DateTime              @updatedAt
23 
24   resetTokens  PasswordResetToken[]
25 }
26 
27 model PasswordResetToken {
28   id        String   @id @default(cuid())
29   token     String   @unique
30   user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
31   userId    String
32   expiresAt DateTime
33   createdAt DateTime @default(now())
34 }
35 
36 model Event {
37   id          String     @id @default(cuid())
38   name        String
39   type        EventType
40   description String?    // para eventos free (e outros) descreverem detalhes
41   location    String?    // local do evento
42   inviteSlug  String?    @unique // usado para gerar link de convite
43   createdAt   DateTime   @default(now())
44 }

===== app/(app)/dashboard/DashboardClient.tsx =====
1 "use client";
2 
3 import { useEffect, useState } from "react";
4 import Link from "next/link";
5 
6 type EventType = "PRE_PAGO" | "POS_PAGO" | "FREE";
7 
8 type Event = {
9   id: string;
10   name: string;
11   type: EventType;
12   createdAt: string;
13 };
14 
15 function getTypeLabel(type: EventType) {
16   if (type === "PRE_PAGO") return "Pré pago";
17   if (type === "POS_PAGO") return "Pós pago";
18   return "Free";
19 }
20 
21 function getEventHref(event: Event) {
22   if (event.type === "PRE_PAGO") return `/eventos/${event.id}/pre`;
23   if (event.type === "POS_PAGO") return `/eventos/${event.id}/pos`;
24   return `/eventos/${event.id}/free`;
25 }
26 
27 export default function DashboardClient() {
28   const [events, setEvents] = useState<Event[]>([]);
29   const [loading, setLoading] = useState(true);
30   const [error, setError] = useState<string | null>(null);
31 
32   const [name, setName] = useState("");
33   const [type, setType] = useState<EventType>("FREE");
34   const [creating, setCreating] = useState(false);
35 
36   useEffect(() => {
37     let active = true;
38 
39     async function load() {
40       try {
41         setLoading(true);
42         setError(null);
43 
44         const res = await fetch("/api/eventos");
45         if (!res.ok) {
46           const data = await res.json().catch(() => null);
47           if (!active) return;
48           setError(data?.error ?? "Erro ao carregar eventos.");
49           return;
50         }
51 
52         const data = (await res.json()) as Event[];
53         if (!active) return;
54         setEvents(data);
55       } catch (err) {
56         console.error(err);
57         if (!active) return;
58         setError("Erro inesperado ao carregar eventos.");
59       } finally {
60         if (!active) return;
61         setLoading(false);
62       }
63     }
64 
65     load();
66 
67     return () => {
68       active = false;
69     };
70   }, []);
71 
72   async function handleCreate(e: React.FormEvent) {
73     e.preventDefault();
74     if (!name.trim()) {
75       setError("Informe um nome para o evento.");
76       return;
77     }
78 
79     try {
80       setCreating(true);
81       setError(null);
82 
83       const res = await fetch("/api/eventos", {
84         method: "POST",
85         headers: {
86           "Content-Type": "application/json",
87         },
88         body: JSON.stringify({
89           name,
90           type,
91         }),
92       });
93 
94       if (!res.ok) {
95         const data = await res.json().catch(() => null);
96         setError(data?.error ?? "Erro ao criar evento.");
97         return;
98       }
99 
100       const created = (await res.json()) as Event;
101 
102       setEvents((prev) => [created, ...prev]);
103       setName("");
104       setType("FREE");
105     } catch (err) {
106       console.error(err);
107       setError("Erro inesperado ao criar evento.");
108     } finally {
109       setCreating(false);
110     }
111   }
112 
113   async function handleDelete(id: string) {
114     try {
115       setError(null);
116 
117       const res = await fetch("/api/eventos", {
118         method: "DELETE",
119         headers: {
120           "Content-Type": "application/json",
121         },
122         body: JSON.stringify({ id }),
123       });
124 
125       if (!res.ok) {
126         const data = await res.json().catch(() => null);
127         setError(data?.error ?? "Erro ao excluir evento.");
128         return;
129       }
130 
131       setEvents((prev) => prev.filter((e) => e.id !== id));
132     } catch (err) {
133       console.error(err);
134       setError("Erro inesperado ao excluir evento.");
135     }
136   }
137 
138   return (
139     <div className="min-h-screen bg-slate-950 text-slate-50 flex flex-col">
140       <header className="flex items-center justify-between px-6 py-4 border-b border-slate-800">
141         <h1 className="text-lg sm:text-xl font-semibold">
142           Meus eventos
143         </h1>
144 
145         <button
146           type="button"
147           className="text-xs font-medium text-slate-300 hover:text-slate-100"
148         >
149           Sair
150         </button>
151       </header>
152 
153       <main className="flex-1 px-4 py-6 sm:px-6 lg:px-8 max-w-5xl w-full mx-auto flex flex-col gap-6">
154         {/* Form de criação */}
155         <form
156           onSubmit={handleCreate}
157           className="flex flex-col gap-3 rounded-2xl border border-slate-800 bg-slate-900/50 p-4 sm:flex-row sm:items-end sm:gap-4"
158         >
159           <div className="flex-1 flex flex-col gap-1">
160             <label className="text-xs font-medium text-slate-300">
161               Nome do evento
162             </label>
163             <input
164               type="text"
165               value={name}
166               onChange={(e) => setName(e.target.value)}
167               className="rounded-lg border border-slate-700 bg-slate-950 px-3 py-2 text-sm text-slate-50 placeholder:text-slate-500 shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-500"
168               placeholder="Digite o nome do evento"
169             />
170           </div>
171 
172           <div className="w-full sm:w-40 flex flex-col gap-1">
173             <label className="text-xs font-medium text-slate-300">
174               Tipo
175             </label>
176             <select
177               value={type}
178               onChange={(e) => setType(e.target.value as EventType)}
179               className="rounded-lg border border-slate-700 bg-slate-950 px-3 py-2 text-sm text-slate-50 shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-500"
180             >
181               <option value="FREE">Free</option>
182               <option value="PRE_PAGO">Pré pago</option>
183               <option value="POS_PAGO">Pós pago</option>
184             </select>
185           </div>
186 
187           <button
188             type="submit"
189             disabled={creating}
190             className="inline-flex items-center justify-center rounded-lg bg-emerald-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-emerald-500 disabled:opacity-60"
191           >
192             {creating ? "Criando..." : "Adicionar evento"}
193           </button>
194         </form>
195 
196         {error && (
197           <p className="text-sm text-red-400">
198             {error}
199           </p>
200         )}
201 
202         {loading && (
203           <p className="text-sm text-slate-300">Carregando eventos...</p>
204         )}
205 
206         {!loading && events.length === 0 && (
207           <p className="text-sm text-slate-400">
208             Nenhum evento criado ainda. Crie o primeiro acima.
209           </p>
210         )}
211 
212         {/* Grid de cards */}
213         <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
214           {events.map((event) => (
215             <div
216               key={event.id}
217               className="flex flex-col justify-between rounded-2xl border border-slate-800 bg-slate-900/60 p-4"
218             >
219               <div className="flex flex-col gap-1">
220                 <span className="text-[11px] uppercase tracking-wide text-slate-400">
221                   {getTypeLabel(event.type)}
222                 </span>
223                 <h2 className="text-sm font-semibold text-slate-50 line-clamp-2">
224                   {event.name}
225                 </h2>
226               </div>
227 
228               <div className="mt-4 flex items-center justify-between gap-2">
229                 <Link
230                   href={getEventHref(event)}
231                   className="inline-flex items-center justify-center rounded-lg bg-slate-800 px-3 py-1.5 text-xs font-medium text-slate-50 hover:bg-slate-700"
232                 >
233                   Abrir
234                 </Link>
235 
236                 <button
237                   type="button"
238                   onClick={() => handleDelete(event.id)}
239                   className="inline-flex items-center justify-center rounded-lg border border-red-600 px-3 py-1.5 text-xs font-medium text-red-400 hover:bg-red-950/50"
240                 >
241                   Excluir
242                 </button>
243               </div>
244             </div>
245           ))}
246         </div>
247       </main>
248     </div>
249   );
250 }

===== app/(app)/eventos/[id]/EventTipoClient.tsx =====
1 "use client";
2 
3 import { useEffect, useState } from "react";
4 import Link from "next/link";
5 
6 type EventType = "PRE_PAGO" | "POS_PAGO" | "FREE";
7 
8 type Event = {
9   id: string;
10   name: string;
11   type: EventType;
12 };
13 
14 type Mode = "free" | "pre" | "pos";
15 
16 type Props = {
17   eventId: string;
18   mode: Mode;
19 };
20 
21 function getTitle(mode: Mode) {
22   if (mode === "pre") return "Evento pré pago";
23   if (mode === "pos") return "Evento pós pago";
24   return "Evento free";
25 }
26 
27 function getDescription(mode: Mode) {
28   if (mode === "pre") {
29     return "Aqui terá a lógica do evento pré pago.";
30   }
31   if (mode === "pos") {
32     return "Aqui terá a lógica do evento pós pago.";
33   }
34   return "Aqui terá a lógica do evento free.";
35 }
36 
37 export default function EventTipoClient({ eventId, mode }: Props) {
38   const [event, setEvent] = useState<Event | null>(null);
39   const [loading, setLoading] = useState(true);
40   const [error, setError] = useState<string | null>(null);
41 
42   useEffect(() => {
43     let active = true;
44 
45     async function load() {
46       try {
47         setLoading(true);
48         setError(null);
49 
50         const res = await fetch("/api/eventos");
51         if (!res.ok) {
52           const data = await res.json().catch(() => null);
53           if (!active) return;
54           setError(data?.error ?? "Erro ao carregar eventos.");
55           return;
56         }
57 
58         const data = (await res.json()) as Event[];
59         if (!active) return;
60 
61         const found = data.find((e) => e.id === eventId) ?? null;
62         if (!found) {
63           setError("Evento não encontrado.");
64           setEvent(null);
65           return;
66         }
67 
68         setEvent(found);
69       } catch (err) {
70         console.error(err);
71         if (!active) return;
72         setError("Erro inesperado ao carregar evento.");
73       } finally {
74         if (!active) return;
75         setLoading(false);
76       }
77     }
78 
79     load();
80 
81     return () => {
82       active = false;
83     };
84   }, [eventId]);
85 
86   return (
87     <div className="min-h-screen bg-slate-950 text-slate-50 flex flex-col">
88       <header className="flex items-center justify-between px-6 py-4 border-b border-slate-800">
89         <Link
90           href="/dashboard/"
91           className="text-xs font-medium text-slate-300 hover:text-slate-100"
92         >
93           ← Voltar
94         </Link>
95 
96         {event && (
97           <span className="inline-flex items-center rounded-full bg-slate-900 px-3 py-1 text-[11px] font-medium uppercase tracking-wide text-slate-300 border border-slate-700">
98             {event.type}
99           </span>
100         )}
101       </header>
102 
103       <main className="flex-1 px-4 py-6 sm:px-6 lg:px-8 max-w-3xl w-full mx-auto flex flex-col gap-4">
104         {loading && (
105           <p className="text-sm text-slate-300">Carregando evento...</p>
106         )}
107 
108         {error && !loading && (
109           <p className="text-sm text-red-400">{error}</p>
110         )}
111 
112         {!loading && !error && !event && (
113           <p className="text-sm text-slate-300">
114             Evento não encontrado.
115           </p>
116         )}
117 
118         {event && (
119           <>
120             <h1 className="text-xl sm:text-2xl font-semibold text-slate-50">
121               {event.name}
122             </h1>
123 
124             <h2 className="text-sm font-medium text-slate-200">
125               {getTitle(mode)}
126             </h2>
127 
128             <p className="text-sm text-slate-300">
129               {getDescription(mode)}
130             </p>
131 
132             <p className="mt-4 text-[11px] text-slate-500">
133               (No futuro, aqui vamos montar toda a lógica detalhada desse tipo
134               de evento: configurações, regras, integrações, fluxos, etc.)
135             </p>
136           </>
137         )}
138       </main>
139     </div>
140   );
141 }

===== app/(app)/eventos/[id]/[tipo]/page.tsx =====
[MISSING] app/(app)/eventos/[id]/[tipo]/page.tsx
